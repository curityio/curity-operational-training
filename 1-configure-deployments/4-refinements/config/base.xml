<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>#{RUNTIME_BASE_URL}</base-url>
      <admin-service>
        <http>
          <base-url>#{ADMIN_BASE_URL}</base-url>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.ZkdpaXNrc2h2YmZKQzlYTA==.POtZ2qi7-_A8a0eGGUz2gA==.SO4kgCxoMMiiGv3awZcOZ0X6EtGVl4iiJOnHJuT-muWcu5t8muxVttJElG_8nz8EX4x_Yd83GxCs21j5OHWFYzk26u9nkd3OUKpRFygdkW8=.8ZtVFwB8-HdpnmBMaQkmSKS01XkGLV3YlUJaKHfKRBk=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <webfinger/>
          <endpoints>applications</endpoints>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <connection-string>data:text/plain;aes,v:S.b0prWkdVYVFQQWRiMnIyRA==.7ToG5gVEUZjfNe01QUTDpA==._wjdRyh4roJ8MZXf3T6DEUDRwvF_kOWFrGR_Nzt1G0TpoQFU5sJFyrzsQ54TvoSJ5-MDrtQel8QVv1AYUSQfTqQyfJKGSm5ZixXkgE1E1TkO-7IgIpAub9dYNlQADyXf.zXF3T469ewsKR0OtqiVitCUzuZk-niu0mYQJA84KjEI=</connection-string>
          <standard-credentials-mode>
          </standard-credentials-mode>
          <driver>org.hsqldb.jdbc.JDBCDriver</driver>
          <password>data:text/plain;aes,v:S.cWJMeTFHWkN2aHZwbDAxYw==.5ciUeWiATfDsFv10MZo7og==.ApYud3FjOFk-EayYwi1HUQ==.5FCay5j-BD0HKNwmmF1x2Znx9FDzSBc_Gnb0fjRXGjI=</password>
          <username>SA</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.eUUwRnJzaWJud0w2YzN1cg==.khNqPzqeXSY5zW_XvrimHQ==.w11Xz3wylpGM7N0FAi3Ldmx7Dt_uQPOpmB0Ni0c4IS0Q1NQc85WwFCJH_0vMw8E0mOehmgPOAOXuOE76zjzuXWsujWhFZBhCUe1xWFM1H3T9OOgLMJlJcFOJetBwU9xAZAtETWln8Zy0aAgM9F9-3puJz_8MYyDWOFXZVY16eTxNhCp_hTmtCylqd3VMu_9KAyMemK05SP5RtxUR0NXQJKpITetagcsN-rMG4BaLGIVEUFWkNzFSt97EUaEfxHCdpe-vlDqNn0D832jFrkVF_WgG7jg2Y-E9IZVHJUmnqA4qS5tcTgvONZtbyyFn2CFPn9T5JVDZylzv-1a6wlVNmLESBa_NyOWELs-GZXCNDmroWmK4MfHPlRz2TH4RWE-KAyyHX_AI5LinF5fNSn61dRV7D_uWJcsaG4PtbtMtsARPBQDA38ZHjYHcWZFPql10lubFnTfmQQ0ZGbyM65CKx9D8VcfnvEyw9ObGBqRSvOzmDp2G-C-5sjU0EbgkDyIDj2_s-NE0wB96bl08ygmdmfop3XWa9IsunNRrcNJRlB95x-0d32oVi6ESAAhY4xaJPOmr466rRKlF0XkqlZGoa5ZdQgYYIL6aJ_1yI_FUcB5MAo7fzenIsqZ2X6Fr-eQWP-RlQCrPvQGYAi03j86wv4jfqKUtjVhaLL71E_9M78wphY411weLnOH67i8Ey1O3KU4SGaCsqu7z-wcUn7vpCXFv5K_UzXq5dLo1jtMjrdYmB-buqv78S96-6oQTTM_pgCLNLlAyO_-NDryGgsdhbj76JM9LAvMVZp-3JMeiB1VAjRntTD8Xj89zd2cp2CU9PtyIBgp9BySWESx8v81uwJzT3hC4gT6RNNpUclUoXodK2IbfWj1DG9VFTTRJhD_i7SCBuz2RbNXltsk7xDl8z0gLZ7wO9fkPw-lMxrnkH8CL3xJu2aWdE-PM3MSdfrz-unpoqXtxXgQWMi84nRSgnY_YUFuNe9f_H2AS__kqQOWSeqPIs7G-nhBiITA-YiFbFI8pYcpxuRHzx1nVdvW3BGx5IRwmBEmAFOgK2RZhZIP4kMdEqVGodO9sJY-uE02Iqr75yIjAeIxmWdWU--zyzmWJjOSYjaRk9Z8hhanRgiqisT5w-GIKPSXrc1pdOlQw-vl4d-wOP4ycx7ip9YGwaA9NAmJNfCVqOWYHmeb3kThuGqAkPjl9XPMXkJujjp48SaU5ecootRvLgYSLispVwMKg--sjx3HUg_rPseF80l6t_Ukqcs7rRhGKmdgiKoGBlCdnZZjA7WeJtktLaKYBOVXwiOgrymg5xdYdPan7tLWFiZ-3hW8qfGTCgvd-l1irJYOzLoNnekwfAoR0a1HVcfU_4GQ42m6cpzA2nsv5L5DuKOE392P7-iC2tplIygzPfTH6cDVLXJOgpSmpb15M5jOJPFC6re8BUzPE6KV2pD2NYnQC6Ml4a6J3NXc63Jzp3yP11lI-D51QSpGJkqyfH4MLit9rsyWgowi-zZAJoqD7LVRN4hoCggmAjxTHBbCXO2HpO1bA5MAg2saxSM390MLvmZuf_iXEbMcvE9dlcNfWwgXkHsBgvhmJ_XyWU0sb3iG1wp-UbwIxA6C4Vvt6X6q-JvknH_zVA2IZ1wweranrSicRRV5NEZ9Dd32bwo1aI0MrTaW6QjmyFWDrEo-Go8OmC8czbJrch26Tkxu7qpwzXjKzyV_iOW8QnI8lVMhTUVs25vheOp5OwDyRA-92iXMgcBepf1DF5wpwU9lrDllkwZgAtBCJMKMkKqdWBEzwDD1cEurThRCzrqtw7g_3_MEzCbRaYe0fhTx5beEhzBxNO9pB1O0ys6l1WuFK5AnQaZXI_tprCOMXj7_51JkHUY4l_5eJzQCa_JLC8Ng8ywbIb6cW5IwQJlixllGNXNr2JfzlYZKlN6gFDEzlM3BAGzC1vfeJxFSr95i5dKAx25rnnQLZ4SD3Gx71JgiXPTCs3bo2ULsIZQ-YYyk-IAjGH46Pa2sarY82UQwppk7LXPFJt9Yakqf3h7WFGo4W_GFXDPbPv8X-Vzz-KD5qqXwo8VpNPuPKgkWdy4aYHZOaIqWe34haBRFxs9erlcVbGVDD5i_ba94AHEVUKwuD6R0vfeQ8Rq1g6j4IDP-62Zw5FtJYlUqvuSISnXFC5JFfgVnkEulSggQPKTVWoJ2Tgd7TkdvsmWxBTU9_ToAcm6VMTDhEi8u_elXXpXG2hMQapdCJdKP8q7W3ccQa1r63Mws2KL6YB_mWlT7Kk2kkgxVGuqV2ImXPi1PQaEb__wWA3YjtSbtqh21EGcpIpk9fHp5SFosKu5h98_1Mo_f9mqKi8x4LXBi3hZInAb74ReV5RvMMadjHuEfZNJ1KgRBKNLCiiQupRRKVa9aeShntZp5sXXQtrdG7itv84Wox6Nb4EQDw_tbjClqYWywiASIRser5w2sCQdFt6UAFpCZkT3VzTtRTQcVw0IYMgfoEc_dtZdNd8b3ltck8VBe5Iacd4GXm-NHbQE0hfgZvLzyDbgHomtoz-hDo9kS2chA2zhxqOxWwdPYIP5QIkldK1Ni8QNy7NnVyhoUcGgjaJoGLNnqCrV61i0BH8rip5b025hbU6M03eWQ2128h09QV_qIGuIbWt-d98NTDM3LwrCJUeLW41r9Wl1TIHG4asbrPNX-zJtbTNZx90a5ZE6XcDEST9Ijmx0cFxww-IWIreccOksS1dnCcuv0Bbi6-N_SFy2C-aIpLjzW4LI9YwlgHnGR9GBqywt4TG59Z98Nktqv6Blt9LK_ePm4KlRpbmc_GmUVREOfGRsXJ0PydQxWv7ff53u7nn1rSAbtKHaQfXYF1UY8JQtZOya9nVtNzkbn3HpPBO61bn724qUHShOfzO_t5OljN7u-rtRGPTtgMcvWvvaEQGGMfMccqTnEB4UX3NH7uTQYqDhQaadNmMSc5RYGMvEoFfXdvGRdD1tR4Jh6f2b7L6zayaX_JektLzqxJjhkBKM6GHQWNDIqZbtX1AnX80oOBPZ_Cg_6k0TQ_HdTCRBA8SzxX8LBP2blPb1oi7DhNDqHRQ3sogUX8q8jfvDE-EiRZzPADANIcmvbdgLaJoxP0YY_7kZaeydFOVqmP9vIjJf-8nfmJGR90gl05mHI_84jOaX3YVRlcVfuKdzvLp7TuwWFJGQwlSjZCbmu-CHMjmSDfUxoqvdtdoRTeMEEBDHhcOMwZW-voBQfKfXFvwgzgIrMidO_nYF3Q954jl2rSdLsy0DZZIVzuf5wshq-Fm1DwZMSMM7RxCqgttR1A7J8tsn_fvCmpMIal0BmSS_JmJPmeI1eym9iV37XDhBlVz8JiaXgIjHk6mW0tlr5zoD4c-vW_VtBD_nOx3N7IzdKEP5_8LalUjujWuBPgPkHf1UwifDgVrfXBiOXwuBcdGf9p4bbHKcyeCvmJqsP6QQzB8Pfl3aavCFAXlesTvFWwLJJDHWzpih5dImbr8tf1jStzXputhX1IyOyB37c4WM-C7Q-6ITMJcMwfcGNJ6NSmwz9xewi7uyLNyUlrp8N_sgqj7PRAO1LHxAo3Ok-ybj6QUqq9jn6YyhW9281LlTdPU1HxzQ==.hAXzYwppS7RXXQ45-KiQjWWTqOK9oLSU8FRgjekjkWM=</keystore>
        </signing-key>
      </signing-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$a9udr2yj$vlzycEYAorGqDRNOD8CGgAhjkc/VVdSlkxJTx4tpio4</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>